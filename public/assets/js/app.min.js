!function(i){function s(t,e){t.attr(e,function(t,e){return"true"==e?"false":"true"})}i(document).ready(function(){i('[data-target="menu"], .App-menu').click(function(){i(this).toggleClass("open"),i(".App-menu").toggleClass("open"),i("body, .App-menu").toggleClass("no-scroll")}),i('[data-target="modal"]').click(function(){var t=i(this).data("animate");i("#modal-container").removeAttr("class").addClass(t),i("body").addClass("modal-active")}),i('[data-dismiss="modal"]').click(function(){i("#modal-container").addClass("out"),i("body").removeClass("modal-active")}),c(".sidebar-middle ul li a"),c(".sidebar-bottom ul li a");var t=i(t),e=i(".nav-list__item"),a=i(".menu"),o=i(".language"),n=".nav-list__item-selector";e.on("click",function(){i(this).toggleClass("is-open"),s(i(this).find(n),"aria-expanded"),s(i(this).find(n),"aria-hidden")}),a.on("click",function(){i(this).parent().parent().toggleClass("is-open"),s(i(this).parent().parent(),"aria-hidden")}),o.on("click",function(){i(this).toggleClass("is-open"),s(i(this),"aria-expanded")})});var c=function(t){i(t).each(function(t){this.href.trim()==window.location&&i(this).addClass("active")})}}(jQuery);var Card={config:{protocol:location.protocol,domain:location.hostname,api:"https://"+location.hostname,endpoint:{criarcard:"https://"+location.hostname+"/criarcard",saveimage:"https://"+location.hostname+"/saveimage"}},init:function(){this.afterInit()},afterInit:function(){return this.bindEvents(),this},bindEvents:function(){var t=this;return window.onload=t.verificaSeEstaLogado,$("[data-target='criar']").on("click",t.Login),t.menuCategorias("https://"+location.hostname+"/listarcategorias"),$('form[name="formCriarCard"]').on("submit",t.Criar),this},verificaSeEstaLogado:function(){$("body").hasClass("logged-out")&&(document.getElementById("cardname").disabled=!0,document.getElementById("cardcategory").disabled=!0,document.getElementById("cardurl").disabled=!0,document.getElementById("cardimage").disabled=!0,document.getElementById("cardsubmit").disabled=!0,$("body.logged-out").on("click",function(t){t.stopPropagation(),t.preventDefault(),FB.login(function(t){t.authResponse?FB.api("/me",{fields:"id, age_range, picture, birthday, email, first_name, last_name, gender, location, name"},function(t){t.provider="facebook",t.user_id=t.id,$.ajax({url:"https://"+location.hostname+"/loginsocial",data:JSON.stringify(t),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){Swal({title:"Sucesso!",text:"Login feito com sucesso!",type:"success",showCancelButton:!0}).then(function(t){t.value&&(document.getElementById("cardname").disabled=!1,document.getElementById("cardcategory").disabled=!1,document.getElementById("cardurl").disabled=!1,document.getElementById("cardimage").disabled=!1,document.getElementById("cardsubmit").disabled=!1)})}})}):Swal({type:"error",text:"O usuário cancelou o login ou não autorizou totalmente.",showCloseButton:!0})},{scope:"email, public_profile"})}))},Login:function(t){t.preventDefault(),FB.getLoginStatus(function(t){"connected"===t.status?window.location="/criar":FB.login(function(t){t.authResponse?Swal({title:"Sucesso!",text:"Login feito com sucesso!",type:"success",showCancelButton:!0}).then(function(t){t.value&&FB.api("/me",{fields:"id, age_range, picture, birthday, email, first_name, last_name, gender, location, name"},function(t){t.provider="facebook",t.user_id=t.id,$.ajax({url:"https://"+location.hostname+"/loginsocial",data:JSON.stringify(t),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){window.location="/criar"}})})}):Swal({type:"error",text:"O usuário cancelou o login ou não autorizou totalmente.",showCloseButton:!0})},{scope:"email, public_profile"})})},menuCategorias:function(t){$.get(t,function(t){var a='<option value="">Escolha a Modalidade</option>';t.success&&($.each(t.data,function(t,e){a+='<option value="'+e.id+'">'+e.categoria+"</option>"}),$("#cardcategory").html(a))})},Criar:function(t){t.stopPropagation(),t.preventDefault();var a={};$.each($('input[type="text"], input[type="url"], select'),function(t,e){a[e.name]=e.value});var n={};$.each($("#cardimage")[0].files,function(t,e){n.cardimage=e}),console.log("Montado o objeto"),console.table(a),console.table(n),$.ajax({url:"https://"+location.hostname+"/criarcard",data:a,type:"POST",dataType:"json",before:function(){$('input[type="submit"]',$("#formCriarCard")).prop("disabled",!0),$('input[type="submit"]',$("#formCriarCard")).value("Processsando ...")},success:function(t){console.log("Resposta do ajax que cria o card."),console.table(t),n.data=t.data,console.log("Passando o objeto de retorno para o objeto formData"),console.table(n);var e,a=t.title,o=reponse.message;t.success?Swal.fire({title:"Aguarde...",html:"Estamos salvando os dados.",timer:2e3,onBeforeOpen:function(){Swal.showLoading(),e=setInterval(function(){$.ajax({url:"https://"+location.hostname+"/saveimage",type:"POST",data:n,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(t){console.log("Resposta do ajax que salva a imagem"),console.table(t)}})},100)},onClose:function(){clearInterval(e)}}).then(function(t){t.dismiss===Swal.DismissReason.timer&&Swal({type:"success",title:a,text:o,showCancelButton:!0}).then(function(t){t.value&&(document.getElementById("formCriarCard").reset(),$('input[type="submit"]',$("#formCriarCard")).value("Criar"),$('input[type="submit"]',$("#formCriarCard")).prop("disabled",!1))})}):Swal({type:"error",title:t.title,text:t.message,showCancelButton:!0})}})}};!function(t,e,a){"use strict";jQuery(document).ready(function(){Card.init()})}();var Category={config:{protocol:location.protocol,domain:location.hostname,api:"https://"+location.hostname,endpoint:{listarcategorias:"https://"+location.hostname+"/listarcategorias"}},init:function(){this.afterInit()},afterInit:function(){return this.bindEvents(),this},bindEvents:function(){return this.Listar(this.config.endpoint),this},Listar:function(t){$.get(t.listarcategorias,function(t){var a="";t.success&&($.each(t.data,function(t,e){a+='<li class="nav-selector__item" role="menuitem"><a href="/?categoria='+e.id+'" tabindex="-'+t+'" data-target="link"><span>'+e.categoria+"</span></a></li>"}),$(".nav-list__item-selector").html(a))})}};!function(t,e,a){"use strict";jQuery(document).ready(function(){Category.init()})}();var Facebook={config:{ip:"157.230.157.117",ssh:"root@socialcards.com.br",senha:"s4ndr01972",appId:"598321220616638",protocol:location.protocol,domain:location.hostname,api:"https://"+location.hostname,urlShared:"https://"+location.hostname+"/assets/images/compartilhadas/",endpoint:{loginsocial:"https://"+location.hostname+"/loginsocial",reactsocial:"https://"+location.hostname+"/reactsocial",updatesocial:"https://"+location.hostname+"/updatesocial",verificacep:"https://"+location.hostname+"/verificacep",verificainfluencia:"https://"+location.hostname+"/verificainfluencia",verificareacao:"https://"+location.hostname+"/verificareacao",salvarimagem:"https://"+location.hostname+"/salvarimagem"}},init:function(){console.log(this.config),$.ajaxSetup({cache:!0}),$.getScript("//connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:"598321220616638",cookie:!0,xfbml:!0,version:"v3.2",frictionlessRequests:!0,oauth:!0}),FB.getLoginStatus(function(t){"connected"===t.status?(console.log("Conectado"),$("body").removeClass("logged-out"),$("body").addClass("logged-in")):(console.log("Não conectado"),$("body").removeClass("logged-in"),$("body").addClass("logged-out"))})}),this.afterInit()},afterInit:function(){return this.bindEvents(),this},bindEvents:function(){var i=this;return $("[data-target='compartilhar']").on("click",function(t){t.preventDefault();var e=$(this).parents(".Card"),a={};a.sequencial_card=e.data("sequencial"),a.titulo=e.data("titulo"),a.categoria=e.data("categoria"),a.categoria_id=e.data("cat"),a.url=i.config.api+"/?categoria="+a.categoria_id;var o=document.getElementById("Card-"+a.sequencial_card),n={};"image"in a?console.log("imagem já gerada."):domtoimage.toPng(o).then(function(t){n.nome=i.slugify(a.titulo),n.image=t,$.post(i.config.endpoint.salvarimagem,{data:JSON.stringify(n)},function(t){a.image=i.config.urlShared+t})}).catch(function(t){console.error("oops, something went wrong!",t)}),FB.getLoginStatus(function(t){"connected"===t.status?(a.user_id=t.authResponse.userID,$.ajax({url:i.config.endpoint.verificacep,data:JSON.stringify(a),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){t&&i.verifyInfluence(i.config.endpoint,a)}})):i.Login(i.config.endpoint.loginsocial)})}),$('[data-target="reagir"]').click(function(t){t.preventDefault();var e=$(this).parents(".Card"),a={};a.sequencial_card=e.data("sequencial"),a.titulo=e.data("titulo"),a.categoria=e.data("categoria"),a.social_id=$(this).data("react"),FB.getLoginStatus(function(t){"connected"===t.status?(a.user_id=t.authResponse.userID,$.ajax({url:i.config.endpoint.verificareacao,data:JSON.stringify(a),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){1==t.sucesso?Swal({title:"Atenção!",type:"warning",text:"Você já reagiu nesse Card.",showCancelButton:!0}):i.setReact(i.config.endpoint,a)}})):i.Login(i.config.endpoint.loginsocial)})}),this},slugify:function(t){var e={"-":" ","-":"_",a:"á|à|ã|â|À|Á|Ã|Â",e:"é|è|ê|É|È|Ê",i:"í|ì|î|Í|Ì|Î",o:"ó|ò|ô|õ|Ó|Ò|Ô|Õ",u:"ú|ù|û|ü|Ú|Ù|Û|Ü",c:"ç|Ç",n:"ñ|Ñ"};for(var a in t=t.toLowerCase(),e)t=t.replace(new RegExp(e[a],"g"),a);return t},facebookShare:function(t){setTimeout(function(){FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":t.url,"og:title":t.titulo,"og:description":t.categoria,"og:image":t.image}})},function(t){t.error_code?Swal({type:"error",title:"Código "+t.error_code,html:t.error_message,showCancelButton:!0}):Swal({type:"success",title:"Sucesso!",text:"Card Compartilhado com sucesso.",showCancelButton:!0})})},2e3)},dataURLtoFile:function(t,e){for(var a=t.split(","),o=a[0].match(/:(.*?);/)[1],n=atob(a[1]),i=n.length,s=new Uint8Array(i);i--;)s[i]=n.charCodeAt(i);return new File([s],e,{type:o})},Login:function(e){var a=this;return FB.login(function(t){t.authResponse?a.setDataFbLogin(e):Swal({type:"error",text:"O usuário cancelou o login ou não autorizou totalmente.",showCloseButton:!0})},{scope:"email, public_profile"}),this},consultaCEP:function(e){var a=this;Swal({title:"Digite seu CEP",input:"text",type:"info",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Buscar",showLoaderOnConfirm:!0,preConfirm:function(t){return fetch("//viacep.com.br/ws/"+t+"/json/").then(function(t){if(console.log(t),!t.ok)throw new Error(t.statusText);return t.json()}).catch(function(t){Swal.showValidationMessage("Request failed: "+t)})},allowOutsideClick:function(){Swal.isLoading()}}).then(function(t){t.value&&(e.uf=t.value.uf,e.cidade=t.value.localidade,e.bairro=t.value.bairro,e.cep=t.value.cep,$.ajax({url:a.config.endpoint.updatesocial,data:JSON.stringify(e),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){Swal({type:"success",title:"Parabéns!",text:"Deseja compartilhar esse Card no seu perfil?",showCancelButton:!0,confirmButtonText:"Sim"}).then(function(t){t.value&&a.facebookShare(e)})}}))})},setDataFbLogin:function(e){return Swal({title:"Sucesso!",text:"Login feito com sucesso!",type:"success",showCancelButton:!0}).then(function(t){t.value&&FB.api("/me",{fields:"id, age_range, picture, birthday, email, first_name, last_name, gender, location, name"},function(t){t.provider="facebook",t.user_id=t.id,$.ajax({url:e,data:JSON.stringify(t),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){return!0}})})}),this},setReact:function(e,a){return Swal({type:"success",title:"Sucesso!",text:"Reação feita com sucesso!",showCancelButton:!0}).then(function(t){t.value&&$.ajax({url:e.reactsocial,data:JSON.stringify(a),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){$('article[data-sequencial="'+a.sequencial_card+'"] a[data-react="'+a.social_id+'"] > span').text(t.total).trigger("change")}})}),this},verifyInfluence:function(e,a){var o=this;return $.ajax({url:e.verificainfluencia,data:JSON.stringify(a),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){t.sucesso?Swal({title:"Atenção!",type:"warning",text:"Card já compartilhado. Deseja novamente compartilhar?",showCancelButton:!0,confirmButtonText:"Sim"}).then(function(t){t.value&&o.facebookShare(a)}):o.setInfluence(e.updatesocial,a)}}),this},setInfluence:function(t,e){var a=this;return $.ajax({url:t,data:JSON.stringify(e),type:"POST",crossDomain:!0,dataType:"json",contentType:"application/json",success:function(t){Swal({type:"success",title:"Parabéns!",text:"Deseja compartilhar esse Card no seu perfil?",showCancelButton:!0,confirmButtonText:"Sim"}).then(function(t){t.value&&a.facebookShare(e)})}}),this}};!function(t,e,a){"use strict";jQuery(document).ready(function(){Facebook.init()})}();
//# sourceMappingURL=app.min.js.map